<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
a:visited { COLOR: #000850; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files are part of a reconstructed copy of Comanche 51, the
initial release (though not the final mission release) of the Apollo 11 
Command Module (CM) Apollo Guidance Computer (AGC) software.  The flown, final
release was Comanche 55. The reconstruction is believed to be exactly accurate, 
but in the absence of an actual Apollo-era listing of Comanche 51, some 
explanation of the reconstruction process is needed to insure confidence in 
that accuracy. 
<br><br>
The starting point was the source code of Comanche 55, whose original source code
is available. Comanche 55 source code was then modified by undoing changes known 
to have been made between revisions 51 and 55. The most-significant steps involved 
reverting changes related to the R-2 lunar potential model, the details of which
were known from the previous, separate, independent reconstruction of the Apollo 10
Lunar Module software Luminary 69/2. The now-reconstructed 
Comanche 51 source code was verified by assembling it and checking that the assembled 
code had the expected known-correct memory-bank checksums. Note that page numbers in 
the reconstructed code match those on the Comanche 55 or Luminary 69 printouts, although 
the source code would likely have different page numbers in a contemporary Comanche 51 listing.
<br><br>
Annotations that were not present in the contemporary source code have been added to 
the reconstructed code to justify each change relative to Comanche 55. Here's a guide 
to some of the Apollo documentation relevant to those annotations:<br>
<ul>
<li><a href="https://archive.org/stream/apertureCardBox467Part2NARASW_images#page/n89/mode/1up">
    MIT/IL engineering drawing 2021153D, sheet 3</a>.  Listing of the memory-bank 
    checksums for Comanche 51.</li>
<li><a href="https://archive.org/details/Comanche55J2k60">
       Comanche 55 (Apollo 11 CM final release) assembly listing</a>.</li>
<li><a href="http://www.ibiblio.org/apollo/listings/LUM69R2/MAIN.agc.html">
       Reconstructed Luminary69/2 (Apollo 10 LM final release) assembly listing</a>.</li>
<li><a href="https://archive.org/details/luminary6900miti">
       Luminary 69 (Apollo 10 LM initial release) assembly listing</a>.</li>
<li><a href="https://archive.org/details/Colossus249MartinPp15651719">
       Colossus 249 (Apollo 9 CM final release) assembly listing</a>.</li>
<li><a href="http://www.ibiblio.org/apollo/links.html#PGE_COLOSSUS2">
       <i>Programmed Guidance Equations for Colossus 2, Based on Comanche 55</i></a>. 
       A pseudocode representation of Comanche 55, showing change bars
       for differences from Comanche 45/2.</li>
</ul>
There is also 
<a href="https://github.com/virtualagc/virtualagc/pull/1080">
a short writeup about the reconstruction process in our software repository</a>
that may be helpful.
<br><br>
Comments expected to have been present in the original source code are prefixed with a single '#' symbol, 
whereas comments added later are prefixed by "##" or "###".  Report any errors 
noted by creating an 
issue report at <a href="https://github.com/rburkey2005/virtualagc/issues">the Virtual AGC
Project's GitHub repository</a>.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
061512,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
061513,000003:                                                                                                  <span class="co">## Filename:    KEYRUPT,_UPRUPT.agc</span>
061514,000004:                                                                                                  <span class="co">## Purpose:     A section of Comanche revision 051.</span>
061515,000005:                                                                                                  <span class="co">##              It is part of the reconstructed source code for the</span>
061516,000006:                                                                                                  <span class="co">##              original release of the flight software for the Command</span>
061517,000007:                                                                                                  <span class="co">##              Module's (CM) Apollo Guidance Computer (AGC) for Apollo 11.</span>
061518,000008:                                                                                                  <span class="co">##              The code has been recreated from a copy of Comanche 055. It</span>
061519,000009:                                                                                                  <span class="co">##              has been adapted such that the resulting bugger words</span>
061520,000010:                                                                                                  <span class="co">##              exactly match those specified for Comanche 51 in NASA drawing</span>
061521,000011:                                                                                                  <span class="co">##              2021153D, which gives relatively high confidence that the</span>
061522,000012:                                                                                                  <span class="co">##              reconstruction is correct.</span>
061523,000013:                                                                                                  <span class="co">## Reference:   pp. 1449-1451</span>
061524,000014:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
061525,000015:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
061526,000016:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
061527,000017:                                                                                                  <span class="co">## Mod history: 2019-07-30 MAS  Created from Comanche 55.</span>
061528,000018: 
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1449
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
061530,000020: 14,3761                                           <span class="ps">BANK    </span> 14                                    
061531,000021: 07,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4B455952555054">KEYRUPT</a>                               
061532,000022: 07,2000                                           <span class="ps">BANK    </span>                                       
061533,000023: 07,3673                                           <span class="ps">COUNT*  </span> $$/KEYUP                              
061534,000024: 
<a name="4B45595255505431"></a>061535,000025: 07,3673           54016        <span class="sm">KEYRUPT1</span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
061536,000026: 07,3674           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
061537,000027: 07,3675           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
061538,000028: 07,3676           04414                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
061539,000029: 07,3677           34362                           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  
061540,000030: 07,3700           00006                           <span class="op">EXTEND  </span>                                       
061541,000031: 07,3701           02015                           <span class="op">RAND    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4E4B4559494E">MNKEYIN</a>                               <span class="co">#  CHECK IF KEYS 5M-1M ON</span>
<a name="4B4559434F4D"></a>061542,000032: 07,3702           54073        <span class="sm">KEYCOM  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
061543,000033: 07,3703           40101                           <span class="op">CS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
061544,000034: 07,3704           75001                           <span class="op">MASK    </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543135">BIT15</a>                                 
061545,000035: 07,3705           26101                           <span class="op">ADS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
061546,000036: 
<a name="4143434550545550"></a>061547,000037: 07,3706           34371        <span class="sm">ACCEPTUP</span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4348525052494F">CHRPRIO</a>                               <span class="co">#  (NOTE: RUPTREG4 = KEYTEMP1)</span>
061548,000038: 07,3707           05134                           <span class="op">TC      </span> <a href="EXECUTIVE.agc.html#4E4F564143">NOVAC</a>                                 
061549,000039: 07,3710     0777                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#445350434F554E54">DSPCOUNT</a>                              
061550,000040: 07,3710           02000 60101                     <span class="ps">2CADR   </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#43484152494E">CHARIN</a>                                
061551,000041: 
061552,000042: 07,3712           30073                           <span class="op">CA      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
061553,000043: 07,3713           50064                           <span class="op">INDEX   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4C4F43435452">LOCCTR</a>                                
061554,000044: 07,3714           54154                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D504143">MPAC</a>                                  <span class="co">#  LEAVE 5 BIT KEY CDE IN MPAC FOR CHARIN</span>
061555,000045: 07,3715           05333                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
061556,000046: 
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1450
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
061558,000048:                                                                                                  <span class="co">#  UPRUPT PROGRAM</span>
061559,000049: 
<a name="555052555054"></a>061560,000050: 07,3716           54016        <span class="sm">UPRUPT  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
061561,000051: 07,3717           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
061562,000052: 07,3720           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
061563,000053: 07,3721           04414                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
061564,000054: 07,3722           35021                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#5A45524F">ZERO</a>                                  
061565,000055: 07,3723           56045                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#494E4C494E4B">INLINK</a>                                
061566,000056: 07,3724           54073                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
061567,000057: 07,3725           35015                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495433">BIT3</a>                                  <span class="co">#  TURN ON UPACT LIGHT</span>
061568,000058: 07,3726           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  (BIT 3 OF CHANNEL 11)</span>
061569,000059: 07,3727           05011                           <span class="op">WOR     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4453414C4D4F5554">DSALMOUT</a>                              
<a name="555052505431"></a>061570,000060: 07,3730           34362        <span class="sm">UPRPT1  </span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  TEST FOR TRIPLE CHAR REDUNDANCY</span>
061571,000061: 07,3731           70073                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 OF WORD</span>
061572,000062: 07,3732           56073                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 INTO KEYTEMP1</span>
061573,000063: 07,3733           00006                           <span class="op">EXTEND  </span>                                       
061574,000064: 07,3734           75006                           <span class="op">MP      </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 <span class="co">#  SHIFT RIGHT 5</span>
061575,000065: 07,3735           54734                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              
061576,000066: 07,3736           74362                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  MID 5</span>
061577,000067: 07,3737           63773                           <span class="op">AD      </span> <a href="#48493130">HI10</a>                                  
061578,000068: 07,3740           03770                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
061579,000069: 07,3741           35006                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 
061580,000070: 07,3742           00006                           <span class="op">EXTEND  </span>                                       
061581,000071: 07,3743           70734                           <span class="op">MP      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              <span class="co">#  SHIFT RIGHT 5</span>
061582,000072: 07,3744           74362                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  HIGH 5</span>
061583,000073: 07,3745           40000                           <span class="op">COM     </span>                                       
061584,000074: 07,3746           03770                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
061585,000075: 
<a name="55504F4B"></a>061586,000076: 07,3747           43776        <span class="sm">UPOK    </span>           <span class="op">CS      </span> <a href="#454C52434F4445">ELRCODE</a>                               <span class="co">#  CODE IS GOOD.  IF CODE = 'ERROR RESET',</span>
061587,000077: 07,3750           60073                           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  CLEAR UPLOCKFL (SET BIT4 OF FLAGWRD7 = 0)</span>
061588,000078: 07,3751           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  IF CODE DOES NOT = 'ERROR RESET', ACCEPT</span>
061589,000079: 07,3752           13760                           <span class="op">BZF     </span> <a href="#434C55504C4F434B">CLUPLOCK</a>                              <span class="co">#  CODE ONLY IF UPLOCKFL IS CLEAR (=0).</span>
061590,000080: 
061591,000081: 07,3753           35014                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  TEST UPLOCKFL FOR 0 OR 1.</span>
061592,000082: 07,3754           70103                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
061593,000083: 07,3755           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
061594,000084: 07,3756           05333                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                <span class="co">#  UPLOCKFL = 1</span>
061595,000085: 07,3757           03706                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              <span class="co">#  UPLOCKFL = 0</span>
061596,000086: 
<a name="434C55504C4F434B"></a>061597,000087: 07,3760           45014        <span class="sm">CLUPLOCK</span>           <span class="op">CS      </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  CLEAR UPLOCKFL (I.E., SET BIT 4 OF</span>
061598,000088: 07,3761           70103                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  FLAGWRD7 = 0)</span>
061599,000089: 07,3762           54103                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
061600,000090: 07,3763           03706                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              
061601,000091: 
061602,000092:                                                                                                  <span class="co">#  CODE IS BAD</span>
<a name="544D4641494C32"></a>061603,000093: 07,3764           40103        <span class="sm">TMFAIL2 </span>           <span class="op">CS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  LOCK OUT FURTHER UPLINK ACTIVITY</span>
061604,000094: 07,3765           75014                           <span class="op">MASK    </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495434">BIT4</a>                                  <span class="co">#  (BY SETTING UPLOCKFL = 1) UNTIL</span>
061605,000095: 07,3766           26103                           <span class="op">ADS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  'ERROR RESET' IS SENT VIA UPLINK.</span>
061606,000096: 07,3767           05333                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
<a name="555054455354"></a>061607,000097: 07,3770           60073        <span class="sm">UPTEST  </span>           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1451
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
061609,000099: 07,3771           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
061610,000100: 07,3772           03764                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
<a name="48493130"></a>061611,000101: 07,3773           77740        <span class="sm">HI10    </span>           <span class="ps">OCT     </span> 77740                                 
061612,000102: 07,3774           03764                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
061613,000103: 07,3775           00002                           <span class="op">TC      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
061614,000104: 
<a name="454C52434F4445"></a>061615,000105: 07,3776           00022        <span class="sm">ELRCODE </span>           <span class="ps">OCT     </span> 22                                    
061616,000106: 
061617,000107:                                                                                                  <span class="co">#  'UPLINK ACTIVITY LIGHT' IS TURNED OFF BY .....</span>
061618,000108:                                                                                                  <span class="co">#        1.      VBRELDSP</span>
061619,000109:                                                                                                  <span class="co">#        2.      ERROR RESET</span>
061620,000110:                                                                                                  <span class="co">#        3.      UPDATE PROGRAM (P27) ENTERED BY V70,V71,V72, AND V73.</span>
061621,000111: 
061622,000112:                                                                                                  <span class="co">#                                     -</span>
061623,000113:                                                                                                  <span class="co">#  THE RECEPTION OF A BAD CODE (I.E  CCC FAILURE) LOCKS OUT FURTHER UPLINK ACTIVITY BY SETTING BIT4 OF FLAGWRD7 = 1.</span>
061624,000114:                                                                                                  <span class="co">#  THIS INDICATION WILL BE TRANSFERRED TO THE GROUND BY THE DOWNLINK WHICH DOWNLINKS ALL FLAGWORDS.</span>
061625,000115:                                                                                                  <span class="co">#  WHEN UPLINK ACTIVITY IS LOCKED OUT, IT CAN BE ALLOWED WHEN THE GROUND UPLINKS AND 'ERROR RESET' CODE.</span>
061626,000116:                                                                                                  <span class="co">#  (IT IS RECOMMENDED THAT THE 'ERROR LIGHT RESET' CODE IS PRECEEDED BY 16 BITS THE FIRST OF WHICH IS 1 FOLLOWED</span>
061627,000117:                                                                                                  <span class="co">#  BY 15 ZEROES.  THIS WILL ELIMINATE EXTRANEOUS BITS FROM INLINK WHICH MAY HAVE BEEN LEFT OVER FROM THE ORIGINAL</span>
061628,000118:                                                                                                  <span class="co">#  FAILURE)</span>
061629,000119: 
061630,000120:                                                                                                  <span class="co">#  UPLINK ACTIVITY IS ALSO ALLOWED (UNLOCKED) DURING FRESH START WHEN FRESH START SETS BIT4 OF FLAGWRD7 = 0.</span>
061631,000121: 
061632,000122: 

End of include-file KEYRUPT,_UPRUPT.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
