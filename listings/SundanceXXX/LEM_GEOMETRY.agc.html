<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source code files are a reconstruction of Sundance, the Apollo 9 LM (Lunar Module) AGC
(Apollo Guidance Computer) flight software, created from binary dumps of original core rope
program modules, as follows:
<ul>
<li>B1 &mdash; Revision 292</li>
<li>B2 &mdash; Revision 302</li>
<li>B3 &mdash; Revision 302</li>
<li>B4 &mdash; Revision 302</li>
<li>B5 &mdash; Revision 292</li>
<li>B6 &mdash; Revision 306</li>
</ul>

This means that source code
does not represent a specific historical revision of Sundance, but rather a mixture of the
three released versions. Nonetheless, it is capable of flying the whole Apollo 9 mission.
This source code matches the binary dumps, as closely as feasible, but 100% match is not possible, 
due <i>mostly</i> to changes in memory addresses at which code and variables were allocated in 
different revisions of Sundance.  Refer to 
<a href="https://github.com/virtualagc/virtualagc/blob/master/SundanceXXX/SundanceXXXDifferences.txt">
<u>this list of explanations for each binary mismatch</u></a>.
<br><br>
Since only binary dumps (rather than listings) of Sundance are available as source material, 
all comments and labels are approximate.
They have been taken from other AGC programs where possible, or, in some places, written
from scratch to match what we believe would have been in the original listing.

</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
011703,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
011704,000003:                                                                                                  <span class="co">## Filename:    LEM_GEOMETRY.agc</span>
011705,000004:                                                                                                  <span class="co">## Purpose:     A section of a reconstructed, mixed version of Sundance</span>
011706,000005:                                                                                                  <span class="co">##              It is part of the reconstructed source code for the Lunar</span>
011707,000006:                                                                                                  <span class="co">##              Module's (LM) Apollo Guidance Computer (AGC) for Apollo 9.</span>
011708,000007:                                                                                                  <span class="co">##              No original listings of this program are available;</span>
011709,000008:                                                                                                  <span class="co">##              instead, this file was created via disassembly of dumps</span>
011710,000009:                                                                                                  <span class="co">##              of various revisions of Sundance core rope modules.</span>
011711,000010:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
011712,000011:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
011713,000012:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
011714,000013:                                                                                                  <span class="co">## Mod history: 2020-06-17 MAS  Created from Luminary 69.</span>
011715,000014:                                                                                                  <span class="co">##              2021-05-30 ABS  Replaced use of ANTENBIT with BIT12 to match</span>
011716,000015:                                                                                                  <span class="co">##                              Luminary 69.</span>
011717,000016: 
011718,000017:                                                                                                  <span class="co">## Sundance 302</span>
011719,000018: 
011720,000019: 23,2000                                           <span class="ps">BANK    </span> 23                                    
011721,000020: 13,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4C454D47454F4D">LEMGEOM</a>                               
011722,000021: 13,2000                                           <span class="ps">BANK    </span>                                       
011723,000022: 
011724,000023: 13,2042  30,2000                                  <span class="ps">SBANK=  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4C4F575355504552">LOWSUPER</a>                              
011725,000024: 13,2042  E5,1642                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#58534D">XSM</a>                                   
011726,000025: 
011727,000026:                                                                                                  <span class="co">#  THESE TWO ROUTINES COMPUTE THE ACTUAL STATE VECTOR FOR LM,CSM BY ADDING</span>
011728,000027:                                                                                                  <span class="co">#  THE CONIC R,V AND THE DEVIATIONSR,V. THE STATE VECTORS ARE CONVERTED TO</span>
011729,000028:                                                                                                  <span class="co">#  METERS B-29 AND METERS/CSEC B-7 AND STORED APPROPRIATELY IN RN,VN OR</span>
011730,000029:                                                                                                  <span class="co">#  R-OTHER , V-OTHER FOR DOWNLINK. THE ROUTINES NAMES ARE SWITCHED IN THE</span>
011731,000030:                                                                                                  <span class="co">#  OTHER VEHICLES COMPUTER.</span>
011732,000031: 
011733,000032:                                                                                                  <span class="co">#  INPUT</span>
011734,000033:                                                                                                  <span class="co">#    STATE VECTOR IN TEMPORARY STORAGE AREA</span>
011735,000034:                                                                                                  <span class="co">#    IF STATE VECTOR IS SCALED POS B27 AND VEL B5</span>
011736,000035:                                                                                                  <span class="co">#       SET X2 TO +2</span>
011737,000036:                                                                                                  <span class="co">#    IF STATE VECTOR IS SCALED POS B29 AND VEL B7</span>
011738,000037:                                                                                                  <span class="co">#       SET X2 TO 0</span>
011739,000038: 
011740,000039:                                                                                                  <span class="co">#  OUTPUT</span>
011741,000040:                                                                                                  <span class="co">#    R(T) IN RN, V(T) IN VN, T IN PIPTIME</span>
011742,000041:                                                                                                  <span class="co">#  OR</span>
011743,000042:                                                                                                  <span class="co">#    R(T) IN R-OTHER, V(T) IN V-OTHER   (T IS DEFINED BY T-OTHER)</span>
011744,000043: 
011745,000044: 13,2042                                           <span class="ps">COUNT*  </span> $$/<a href="CONIC_SUBROUTINES.agc.html#47454F4D">GEOM</a>                               
<a name="535644574E32"></a>011746,000045: 13,2042           43414        <span class="sm">SVDWN2  </span>           <span class="in">BOF     </span> <span class="in">RVQ       </span>                            <span class="co">#  SW=1=AVETOMID DOING W-MATRIX INTEG.</span>
011747,000046: 13,2043           04756                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#4156454D49445357">AVEMIDSW</a>                              
011748,000047: 13,2044           26045                                    +1                                    
011749,000048: 13,2045           53775                           <span class="in">VLOAD   </span> <span class="in">VSL*      </span>                            
011750,000049: 13,2046           01521                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5444454C544156">TDELTAV</a>                               
011751,000050: 13,2047           57605                                    0          -7,2                       
011752,000051: 13,2050           53655                           <span class="in">VAD     </span> <span class="in">VSL*      </span>                            
011753,000052: 13,2051           01535                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
011754,000053: 13,2052           57576                                    0,2                                   
011755,000054: 13,2053           25220                           <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#524E">RN</a>                                    
011756,000055: 13,2054           01527                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#544E5556">TNUV</a>                                  
011757,000056: 13,2055           53257                           <span class="in">VSL*    </span> <span class="in">VAD       </span>                            
011758,000057: 13,2056           57602                                    0          -4,2                       
011759,000058: 13,2057           01543                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#564356">VCV</a>                                   
011760,000059: 13,2060           77657                           <span class="in">VSL*    </span>                                       
011761,000060: 13,2061           57576                                    0,2                                   
011762,000061: 13,2062           15226                           <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#564E">VN</a>                                    
011763,000062: 13,2063           01517                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#544554">TET</a>                                   
011764,000063: 13,2064           01234                           <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#50495054494D45">PIPTIME</a>                               
011765,000064: 13,2065           77616                           <span class="in">RVQ     </span>                                       
<a name="535644574E31"></a>011766,000065: 13,2066           53775        <span class="sm">SVDWN1  </span>           <span class="in">VLOAD   </span> <span class="in">VSL*      </span>                            
011767,000066: 13,2067           01521                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5444454C544156">TDELTAV</a>                               
011768,000067: 13,2070           57605                                    0          -7,2                       
011769,000068: 13,2071           53655                           <span class="in">VAD     </span> <span class="in">VSL*      </span>                            
011770,000069: 13,2072           01535                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
011771,000070: 13,2073           57576                                    0,2                                   
011772,000071: 13,2074           25722                           <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#522D4F54484552">R-OTHER</a>                               
011773,000072: 13,2075           01527                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#544E5556">TNUV</a>                                  
011774,000073: 13,2076           53257                           <span class="in">VSL*    </span> <span class="in">VAD       </span>                            
011775,000074: 13,2077           57602                                    0          -4,2                       
011776,000075: 13,2100           01543                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#564356">VCV</a>                                   
011777,000076: 13,2101           77657                           <span class="in">VSL*    </span>                                       
011778,000077: 13,2102           57576                                    0,2                                   
011779,000078: 13,2103           01730                           <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#562D4F54484552">V-OTHER</a>                               
011780,000079: 13,2104           77616                           <span class="in">RVQ     </span>                                       
011781,000080: 
011782,000081:                                                                                                  <span class="co">#           THE FOLLOWING ROUTINE TAKES A HALF UNIT TARGET VECTOR REFERRED TO NAV BASE COORDINATES AND FINDS BOTH</span>
011783,000082:                                                                                                  <span class="co">#  GIMBAL ORIENTATIONS AT WHICH THE RR MIGHT SIGHT THE TARGET. THE GIMBAL ANGLES CORRESPONDING TO THE PRESENT MODE</span>
011784,000083:                                                                                                  <span class="co">#  ARE LEFT IN MODEA AND THOSE WHICH WOULD BE USED AFTER A REMODE IN MODEB. THIS ROUTINE ASSUMES MODE 1 IS TRUNNION</span>
011785,000084:                                                                                                  <span class="co">#  ANGLE LESS THAN 90 DEGS IN ABS VALUE WITH ARBITRARY SHAFT, WITH A CORRESPONDING DEFINITION FOR MODE 2. MODE</span>
011786,000085:                                                                                                  <span class="co">#  SELECTION AND LIMIT CHECKING ARE DONE ELSEWHERE.</span>
011787,000086: 
011788,000087:                                                                                                  <span class="co">#           THE MODE 1 CONFIGURATION IS CALCULATED FROM THE VECTOR AND THEN MODE 2 IS FOUND USING THE RELATIONS</span>
011789,000088: 
011790,000089:                                                                                                  <span class="co">#           S(2) = 180 + S(1)</span>
011791,000090:                                                                                                  <span class="co">#           T(2) = 180 - T(1)</span>
011792,000091: 
011793,000092:                                                                                                  <span class="co">#      THE VECTOR ARRIVES IN MPAC WHERE TRG*SMNG OR *SMNB* WILL HAVE LEFT IT.</span>
011794,000093: 
<a name="5252414E474C4553"></a>011795,000094: 13,2105           00041        <span class="sm">RRANGLES</span>           <span class="in">STORE   </span> 32D                                   
011796,000095: 13,2106           57545                           <span class="in">DLOAD   </span> <span class="in">DCOMP     </span>                            <span class="co">#  SINCE WE WILL FIND THE MODE 1 SHAFT</span>
011797,000096: 13,2107           00043                                    34D                                   <span class="co">#  ANGLE LATER, WE CAN FIND THE MODE 1</span>
011798,000097: 13,2110           67401                           <span class="in">SETPD   </span> <span class="in">ASIN      </span>                            <span class="co">#  TRUNNION BY SIMPLY TAKING THE ARCSIN OF</span>
011799,000098: 13,2111           00001                                    0                                     <span class="co">#  THE Y COMPONENT, THE ASIN GIVING AN</span>
011800,000099: 13,2112           44206                           <span class="in">PUSH    </span> <span class="in">BDSU      </span>                            <span class="co">#  ANSWER WHOSE ABS VAL IS LESS THAN 90 DEG</span>
011801,000100: 13,2113           22274                                    <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4C4F445048414C46">LODPHALF</a>                              
011802,000101: 13,2114           14005                           <span class="in">STODL   </span> 4                                     <span class="co">#  MODE 2 TRUNNION TO 4.</span>
011803,000102: 
011804,000103: 13,2115           22276                                    <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4C4F365A45524F53">LO6ZEROS</a>                              
011805,000104: 13,2116           24043                           <span class="in">STOVL   </span> 34D                                   <span class="co">#  UNIT THE PROJECTION OF THE VECTOR</span>
011806,000105: 13,2117           00041                                    32D                                   <span class="co">#    IN THE X-Z PLANE</span>
011807,000106: 13,2120           41056                           <span class="in">UNIT    </span> <span class="in">BOVB      </span>                            <span class="co">#  IF OVERFLOW, TARGET VECTOR IS ALONG Y</span>
011808,000107: 13,2121           52400                                    <a href="P20-P25.agc.html#4C554E4445534348">LUNDESCH</a>                              <span class="co">#  CALL FOR MANEUVER UNLESS ON LUNAR SURF</span>
011809,000108: 13,2122           14041                           <span class="in">STODL   </span> 32D                                   <span class="co">#  PROJECTION VECTOR.</span>
011810,000109: 13,2123           00041                                    32D                                   
011811,000110: 13,2124           44142                           <span class="in">SR1     </span> <span class="in">STQ       </span>                            
011812,000111: 13,2125           00051                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5332">S2</a>                                    
011813,000112: 13,2126           14023                           <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#53494E5448">SINTH</a>                                 <span class="co">#  USE ARCTRIG SINCE SHAFT COULD BE ARB.</span>
011814,000113: 13,2127           00045                                    36D                                   
011815,000114: 13,2130           77742                           <span class="in">SR1     </span>                                       
011816,000115: 13,2131           34021                           <span class="in">STCALL  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#434F535448">COSTH</a>                                 
011817,000116: 13,2132           47030                                    <a href="INFLIGHT_ALIGNMENT_ROUTINES.agc.html#41524354524947">ARCTRIG</a>                               
011818,000117: 13,2133           43206                           <span class="in">PUSH    </span> <span class="in">DAD       </span>                            <span class="co">#  MODE 1 SHAFT TO 2.</span>
011819,000118: 13,2134           22274                                    <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4C4F445048414C46">LODPHALF</a>                              
011820,000119: 13,2135           24007                           <span class="in">STOVL   </span> 6                                     
011821,000120: 13,2136           00005                                    4                                     
011822,000121: 13,2137           77634                           <span class="in">RTB     </span>                                       <span class="co">#  FIND MODE 2 CDU ANGLES.</span>
011823,000122: 13,2140           21533                                    <a href="RTB_OP_CODES.agc.html#32563153544F3253">2V1STO2S</a>                              
011824,000123: 13,2141           25115                           <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444542">MODEB</a>                                 
011825,000124: 13,2142           00001                                    0                                     
011826,000125: 13,2143           77634                           <span class="in">RTB     </span>                                       <span class="co">#  MODE 1 ANGLES TO MODE A.</span>
011827,000126: 13,2144           21533                                    <a href="RTB_OP_CODES.agc.html#32563153544F3253">2V1STO2S</a>                              
011828,000127: 13,2145           01113                           <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
011829,000128: 13,2146           77776                           <span class="in">EXIT    </span>                                       
011830,000129: 
011831,000130: 13,2147           41101                           <span class="op">CS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5241444D4F444553">RADMODES</a>                              <span class="co">#  SWAP MODEA AND MODEB IF RR IN MODE 2.</span>
011832,000131: 13,2150           75013                           <span class="op">MASK    </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543132">BIT12</a>                                 
011833,000132: 13,2151           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
011834,000133: 13,2152           12156                           <span class="op">TCF     </span> +4                                    
011835,000134: 
011836,000135: 13,2153           53113                           <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
011837,000136: 13,2154           53115                           <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444542">MODEB</a>                                 
011838,000137: 13,2155           53113                           <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
011839,000138: 
011840,000139: 13,2156           06014                           <span class="op">TC      </span> <a href="INTERPRETER.agc.html#494E5450524554">INTPRET</a>                               
011841,000140: 13,2157           77650                           <span class="in">GOTO    </span>                                       
011842,000141: 13,2160           00051                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#5332">S2</a>                                    
011843,000142:                                                                                                  <span class="co">#  GIVEN RR TRUNNION AND SHAFT (T,S) IN TANGNB,+1, FIND THE ASSOCIATED</span>
011844,000143:                                                                                                  <span class="co">#  LINE OF SIGHT IN NAV BASE AXES.  THE HALF UNIT VECTOR, .5(SIN(S)COS(T),</span>
011845,000144:                                                                                                  <span class="co">#  -SIN(T),COS(S)COS(T)) IS LEFT IN MPAC AND 32D.</span>
011846,000145: 
011847,000146: 23,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#494E464C49474854">INFLIGHT</a>                              
011848,000147: 23,2000                                           <span class="ps">BANK    </span>                                       
011849,000148: 
011850,000149: 23,2000                                           <span class="ps">COUNT*  </span> $$/<a href="CONIC_SUBROUTINES.agc.html#47454F4D">GEOM</a>                               
011851,000150: 
<a name="52524E42"></a>011852,000151: 23,2000           47135        <span class="sm">RRNB    </span>           <span class="in">SLOAD   </span> <span class="in">RTB       </span>                            
011853,000152: 23,2001           03744                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54414E474E42">TANGNB</a>                                
011854,000153: 23,2002           21457                                    <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
011855,000154: 23,2003           41401                           <span class="in">SETPD   </span> <span class="in">PUSH      </span>                            <span class="co">#  TRUNNION ANGLE TO 0</span>
011856,000155: 23,2004           00001                                    0                                     
011857,000156: 23,2005           57556                           <span class="in">SIN     </span> <span class="in">DCOMP     </span>                            
011858,000157: 23,2006           14043                           <span class="in">STODL   </span> 34D                                   <span class="co">#  Y COMPONENT</span>
011859,000158: 
011860,000159: 23,2007           41546                           <span class="in">COS     </span> <span class="in">PUSH      </span>                            <span class="co">#  .5 COS(T) TO 0</span>
011861,000160: 23,2010           47135                           <span class="in">SLOAD   </span> <span class="in">RTB       </span>                            
011862,000161: 23,2011           03745                                    <a href="ERASABLE_ASSIGNMENTS.agc.html#54414E474E42">TANGNB</a>     +1                         
011863,000162: 23,2012           21457                                    <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
011864,000163: 23,2013           71406                           <span class="in">PUSH    </span> <span class="in">COS       </span>                            <span class="co">#  SHAFT ANGLE TO 2</span>
011865,000164: 23,2014           72405                           <span class="in">DMP     </span> <span class="in">SL1       </span>                            
011866,000165: 23,2015           00001                                    0                                     
011867,000166: 23,2016           14045                           <span class="in">STODL   </span> 36D                                   <span class="co">#  Z COMPONENT</span>
011868,000167: 
011869,000168: 23,2017           41356                           <span class="in">SIN     </span> <span class="in">DMP       </span>                            
011870,000169: 23,2020           77752                           <span class="in">SL1     </span>                                       
011871,000170: 23,2021           24041                           <span class="in">STOVL   </span> 32D                                   
011872,000171: 23,2022           00041                                    32D                                   
011873,000172: 23,2023           77616                           <span class="in">RVQ     </span>                                       

End of include-file LEM_GEOMETRY.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
